(function(){var n={width:0,height:0,basePath:""},r=function(){var i,u,f,t,n;i=Array.prototype.slice.call(arguments);u=i.shift()||{};for(f in i){t=i[f];for(n in t)t.hasOwnProperty(n)&&(u[n]=typeof t[n]=="object"?r(u[n],t[n]):t[n])}return u},f=function(n,t){return function(i){return window.getComputedStyle?window.getComputedStyle(n,t)[i]:n.currentStyle[i]}},t=function(n){return n.nodeName!=="HTML"&&f(n)("position")==="static"?t(n.offsetParent):n},e=function(){return window.pageXOffset?{x:window.pageXOffset,y:window.pageYOffset}:{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}},u=function(t){var u,r,f,i;return(r=t.indexOf("#"),r===-1)?{src:t,w:0,h:0,x:0,y:0}:(u=t.substring(0,r),f=t.substring(r+1),f.substring(0,5)!=="xywh=")?{src:n.basePath+u,w:0,h:0,x:0,y:0}:(i=f.substring(5).split(","),{src:n.basePath+u,w:parseInt(i[2]),h:parseInt(i[3]),x:parseInt(i[0]),y:parseInt(i[1])})};isMobileDevice=function(){return/Android/.test(window.navigator.userAgent)||/iP(hone|ad|od)/i.test(window.navigator.userAgent)};videojs.registerPlugin("thumbnails",function(f){var h,l,a,y,s,o,c,w,k,b,v,p;n.basePath=f.basePath||n.basePath;y=r({},n,f);o=this;o.on("loadedmetadata",function(){var r=o.textTracks().length,n;if(r!==0){for(i=0;i<r;){if(n=o.textTracks()[i],n.kind==="metadata"&&n.src&&n.src.indexOf(".vtt")>0){v=o.textTracks()[i];v.mode="hidden";break}i++}(function(){var n,i,t;if(navigator.userAgent.toLowerCase().indexOf("android")!==-1){n=o.controlBar.progressControl;i=function(){n.addClass("fake-active")};t=function(){n.removeClass("fake-active")};n.on("touchstart",i);n.on("touchend",t);n.on("touchcancel",t)}})();h=document.createElement("div");h.className="vjs-thumbnail-holder";s=document.createElement("img");h.appendChild(s);s.className="vjs-thumbnail";l=document.createElement("div");l.className="vjs-all-thumbnail-holder";a=document.createElement("div");a.className="vjs-all-thumbnail-wrapper";l.appendChild(a);w=o.duration();o.controlBar.el().appendChild(l);o.on("durationchange",function(){w=o.duration()});o.on("loadedmetadata",function(){w=o.duration()});c=o.controlBar.progressControl;c.el().appendChild(h);k=function(n){var tt,ht,b,r,it,rt,ut,nt,ft,et,d,g,ot,k,f,st;for(ht=0,ft=e().x,et=t(c.el()).getBoundingClientRect(),rt=(et.width||et.right)+ft,it=n.pageX,n.changedTouches&&(it=n.changedTouches[0].pageX),b=it||n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b-=t(c.el()).getBoundingClientRect().left+ft,tt=Math.floor((b-10)/c.seekBar.width()*w),g=v&&v.cues.length,p&&clearTimeout(p),i=0;i<g;){if(d=v.cues[i],d.startTime<=tt&&d.endTime>=tt){r=u(d.text);break}i++}if(ot=i,!isMobileDevice())for(a.innerHTML="",a.style.width=o.controlBar.width()+220+"px",k=Math.ceil(o.controlBar.width()/110),k%2==0&&k++,f=Math.round(i-k/2),g-f<k&&(f=g-k),f<=0&&(f=0),i=0;f<g&&i<k;)d=v.cues[f],st=u(d.text),imgThumb=document.createElement("img"),imgThumb.className="vjs-small-thumbnail",imgThumb.src=st.src,a.appendChild(imgThumb),f==ot&&(imgThumb.className="vjs-selected-thumbnail"),f++,i++;typeof r!="undefined"&&(r.src&&s.src!=r.src&&(s.src=r.src),y.width&&(r.w=y.width),y.height&&(r.h=y.height),(h.style.width!=r.w||h.style.height!=r.h)&&(h.style.width=r.w+"px",h.style.height=r.h+"px"),s.style.left=-r.x+"px",s.style.top=-r.y+"px",s.style.width=r.w+"px",s.style.height=r.h+"px",s.style.clip="rect("+r.y+"px,"+(r.w+r.x)+"px,"+(r.y+r.h)+"px,"+r.x+"px)",ut=r.w,nt=ut/2,b=b+nt>rt?rt-ut:b<nt?0:b-nt,h.style.left=b+"px",isMobileDevice()||(l.style.opacity=1,s.style.display="none",l.style.height="105px"))};c.on("mousemove",k);c.on("touchmove",k);b=function(){h.style.left="-1000px";p&&clearTimeout(p);p=setTimeout(function(){l.style.opacity=0;l.style.height="0px"},500)};c.on("mouseout",b);c.on("touchcancel",b);c.on("touchend",b)}})})})();